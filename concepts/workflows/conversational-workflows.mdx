---
title: Conversational Workflows
description: Learn about conversational workflows in Agno.
---

**Conversational Workflows** enable your workflows to have intelligent conversations with users. 

This feature allows you to add a `WorkflowAgent` to your workflow that intelligently decides whether to:
1. **Answer directly** from workflow session history
2. **Run the workflow** by calling a tool when new processing is needed


<Note>
The `WorkflowAgent` is a restricted version of the `Agent` class specifically designed for workflow orchestration. It uses a tool-based approach to decide when to execute workflows, providing:
- **Better determinism** - Tool calls are explicit and trackable
- **Improved reliability** - Clear decision boundaries between answering and executing
- **Session awareness** - Automatically accesses workflow history for context
</Note>

## Architecture

```
User Input
    ↓
WorkflowAgent (with workflow execution tool)
    ↓
Decision Point:
    ├─ Answer from history (no workflow execution)
    └─ Call `run_workflow` tool (executes workflow)
         ↓
    Workflow Steps Executed
         ↓
    Results stored in session
         ↓
    Response returned to user
```

## Key Components

### 1. `WorkflowAgent` Class
A restricted Agent with limited configuration. See [`WorkflowAgent` Reference](/reference/workflows/workflow_agent) for more details.

<Tip>
Understanding `num_history_runs`

The `num_history_runs` parameter controls how many previous workflow runs the agent can see when making decisions. This is crucial for:

- **Context awareness**: The agent needs to see past runs to answer follow-up questions
- **Memory limits**: Including too many runs can exceed model context limits
- **Performance**: Fewer runs mean faster processing and lower costs

**How it works:**

When a new query arrives, the `WorkflowAgent` retrieves messages from the last `n` runs using:
```python
history = session.get_workflow_history_context(num_runs=num_history_runs)
```
</Tip>

These messages are then added to the agent's context, allowing it to:
- Answer questions about previous results
- Compare outputs from multiple runs
- Understand conversation continuity

### 2. Workflow History Context
Automatically built from previous runs in the session:
```xml
<workflow_history_context>
[run-1]
input: Tell me a story about a husky named Max
response: Once upon a time, there was a...

[run-2]
input: Now tell me about a cat named Luna
response: Luna was a curious cat who...
</workflow_history_context>
```

Read more about [Workflow History](/concepts/workflows/workflow_with_history) for more details.

### 3. Workflow Execution Tool
Automatically created and provided to the agent:
- **Name**: `run_workflow`
- **Purpose**: Execute the complete workflow
- **Effect**: Creates a normal workflow run in the session

## Usage Example

```python
from agno.agent import Agent
from agno.db.postgres import PostgresDb
from agno.models.openai import OpenAIChat
from agno.workflow.agent import WorkflowAgent
from agno.workflow.types import StepInput
from agno.workflow.workflow import Workflow

db_url = "postgresql+psycopg://ai:ai@localhost:5532/ai"


story_writer = Agent(
    model=OpenAIChat(id="gpt-4o-mini"),
    instructions="You are tasked with writing a 100 word story based on a given topic",
)

story_formatter = Agent(
    model=OpenAIChat(id="gpt-4o-mini"),
    instructions="You are tasked with breaking down a short story in prelogues, body and epilogue",
)


def add_references(step_input: StepInput):
    """Add references to the story"""

    previous_output = step_input.previous_step_content

    if isinstance(previous_output, str):
        return previous_output + "\n\nReferences: https://www.agno.com"


# Create a WorkflowAgent that will decide when to run the workflow
workflow_agent = WorkflowAgent(model=OpenAIChat(id="gpt-4o-mini"), num_history_runs=4)

# Create workflow with the WorkflowAgent
workflow = Workflow(
    name="Story Generation Workflow",
    description="A workflow that generates stories, formats them, and adds references",
    agent=workflow_agent,
    steps=[story_writer, story_formatter, add_references],
    db=PostgresDb(db_url),
    # debug_mode=True,
)

# First call - will run the workflow (new topic)
workflow.print_response(
    "Tell me a story about a dog named Rocky",
    stream=True,
    stream_intermediate_steps=True,
)

# Second call - will answer directly from history
workflow.print_response(
    "What was Rocky's personality?", stream=True, stream_intermediate_steps=True
)

# Third call - will run the workflow (new topic)
workflow.print_response(
    "Now tell me a story about a cat named Luna",
    stream=True,
    stream_intermediate_steps=True,
)

# Fourth call - will answer directly from history
workflow.print_response(
    "Compare Rocky and Luna", stream=True, stream_intermediate_steps=True
)
```

## Developer Resources

Explore the different examples in [Conversational Workflows Examples](/examples/concepts/workflows/06_workflows_advanced_concepts/conversational_workflows/conversational_workflow_with_conditional_step) section for more details.