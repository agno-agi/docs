---
title: Disable History Storage
description: Learn how to control whether historical messages are persisted to your database
---

By default, Agno stores all messages from your session in the database, including historical messages from previous runs. This can grow your database quickly, especially for long-running conversations.

The `store_history_messages` flag lets you control this behavior. When set to `False`, historical messages are still used during execution (so your agent or team has access to previous runs/messages as history), but they are not persisted when saving the run to the database.

## Key Concepts

**Runtime vs. Storage**: History is used during execution to provide context, but scrubbed before database persistence. This means:

- ✅ Your agent/team still has access to previous runs/messages as history during the conversation
- ✅ History is added to context as configured by `add_history_to_context` and `num_history_runs`/`num_history_messages`
- ✅ Only the database storage is reduced

## Basic Example

<Tabs>
  <Tab title="Agent">
```python
from agno.agent import Agent
from agno.db.sqlite import SqliteDb
from agno.models.openai import OpenAIChat

agent = Agent(
    model=OpenAIChat(id="gpt-4o-mini"),
    db=SqliteDb(db_file="tmp/agent.db"),
    add_history_to_context=True,    # Enable history during execution
    num_history_runs=3,               # Use last 3 runs for context
    store_history_messages=False,     # Don't persist history in DB
)

# First run establishes context
agent.run("My name is Alice and I love Python programming.")

# Second run uses history (agent remembers) but doesn't store it
agent.run("What is my name and what do I love?")
# Agent responds correctly because history was used during execution

# Check what was stored
stored_run = agent.get_last_run_output()
if stored_run and stored_run.messages:
    history_messages = [m for m in stored_run.messages if m.from_history]
    print(f"Total messages stored: {len(stored_run.messages)}")
    print(f"History messages: {len(history_messages)}")  # Will be 0
```
  </Tab>

  <Tab title="Team">
```python
from agno.team import Team
from agno.agent import Agent
from agno.db.sqlite import SqliteDb
from agno.models.openai import OpenAIChat

team = Team(
    model=OpenAIChat(id="gpt-4o-mini"),
    members=[
        Agent(name="Assistant", role="You help answer questions"),
    ],
    db=SqliteDb(db_file="tmp/team.db"),
    add_history_to_context=True,    # Enable history during execution
    num_history_runs=3,               # Use last 3 runs for context
    store_history_messages=False,     # Don't persist history in DB
)

# First run establishes context
team.run("My name is Alice and I love Python programming.")

# Second run uses history (team remembers) but doesn't store it
team.run("What is my name and what do I love?")
# Team responds correctly because history was used during execution

# Check what was stored
stored_run = team.get_last_run_output()
if stored_run and stored_run.messages:
    history_messages = [m for m in stored_run.messages if m.from_history]
    print(f"Total messages stored: {len(stored_run.messages)}")
    print(f"History messages: {len(history_messages)}")  # Will be 0
```
  </Tab>
</Tabs>

## High-Volume Production Example

For production systems with many users and sessions:

<Tabs>
  <Tab title="Agent">
```python
from agno.agent import Agent
from agno.db.postgres import PostgresDb
from agno.models.openai import OpenAIChat

db = PostgresDb(
    host="localhost",
    port=5432,
    user="agno",
    password="agno",
    database="agno",
)

agent = Agent(
    model=OpenAIChat(id="gpt-4o"),
    db=db,
    add_history_to_context=True,
    num_history_runs=5,
    store_history_messages=False,  # Reduce DB growth
)

# Handle multiple user sessions
agent.run("Help me debug this code", user_id="user_123", session_id="session_456")
```
  </Tab>

  <Tab title="Team">
```python
from agno.team import Team
from agno.agent import Agent
from agno.db.postgres import PostgresDb
from agno.models.openai import OpenAIChat

db = PostgresDb(
    host="localhost",
    port=5432,
    user="agno",
    password="agno",
    database="agno",
)

team = Team(
    model=OpenAIChat(id="gpt-4o"),
    members=[
        Agent(name="Coder", role="You help debug code"),
        Agent(name="Reviewer", role="You review code quality"),
    ],
    db=db,
    add_history_to_context=True,
    num_history_runs=5,
    store_history_messages=False,  # Reduce DB growth
)

# Handle multiple user sessions
team.run("Help me debug this code", user_id="user_123", session_id="session_456")
```
  </Tab>
</Tabs>
