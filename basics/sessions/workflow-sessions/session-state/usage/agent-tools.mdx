---
title: Session State in Agent Tools
sidebarTitle: Agent Tools
description: Access and modify session state from agent and team tools
---

## Basic Usage

Agent and team tools can access session state by adding a `session_state` parameter:

```python
from agno.agent import Agent
from agno.workflow import Workflow
from agno.workflow.step import Step
from agno.db.sqlite import SqliteDb
from agno.models.openai import OpenAIChat

def add_to_cart(session_state: dict, item: str, price: float) -> str:
    """Tool that accesses session state"""
    cart = session_state.get("cart", [])
    cart.append({"item": item, "price": price})
    session_state["cart"] = cart
    
    total = sum(item["price"] for item in cart)
    return f"Added {item} (${price}). Cart total: ${total}"

shopping_agent = Agent(
    name="Shopping Assistant",
    model=OpenAIChat(id="gpt-4o"),
    tools=[add_to_cart],
    instructions="Help users add items to their cart",
)

workflow = Workflow(
    name="Shopping Workflow",
    db=SqliteDb(db_file="shop.db"),
    steps=[Step(name="Shop", agent=shopping_agent)],
    session_state={"cart": []},
)
```

## Multiple Tools Sharing State

Multiple tools in the same agent can share state:

```python
def add_task(session_state: dict, task: str) -> str:
    tasks = session_state.get("tasks", [])
    tasks.append({"task": task, "done": False})
    session_state["tasks"] = tasks
    return f"Added: {task}"

def complete_task(session_state: dict, task_index: int) -> str:
    tasks = session_state.get("tasks", [])
    if 0 <= task_index < len(tasks):
        tasks[task_index]["done"] = True
        session_state["tasks"] = tasks
        return f"Completed task {task_index}"
    return "Invalid task index"

def list_tasks(session_state: dict) -> str:
    tasks = session_state.get("tasks", [])
    if not tasks:
        return "No tasks"
    
    return "\n".join([
        f"{i}. {'✓' if t['done'] else '○'} {t['task']}"
        for i, t in enumerate(tasks)
    ])

task_agent = Agent(
    name="Task Manager",
    model=OpenAIChat(id="gpt-4o"),
    tools=[add_task, complete_task, list_tasks],
)

workflow = Workflow(
    name="Task Management",
    db=SqliteDb(db_file="tasks.db"),
    steps=[Step(name="Manage", agent=task_agent)],
    session_state={"tasks": []},
)
```

## Team Tools with State

Team tools work the same way:

```python
from agno.team import Team

def track_issue(session_state: dict, issue: str) -> str:
    issues = session_state.get("issues", [])
    issues.append(issue)
    session_state["issues"] = issues
    return f"Tracked issue #{len(issues)}"

support_team = Team(
    name="Support Team",
    model=OpenAIChat(id="gpt-4o"),
    members=[...],
    tools=[track_issue],
)

workflow = Workflow(
    name="Support Workflow",
    db=SqliteDb(db_file="support.db"),
    steps=[Step(name="Support", team=support_team)],
    session_state={"issues": []},
)
```

## Stateful Counter Tool

```python
def increment_counter(session_state: dict) -> str:
    count = session_state.get("counter", 0) + 1
    session_state["counter"] = count
    return f"Counter: {count}"

def reset_counter(session_state: dict) -> str:
    session_state["counter"] = 0
    return "Counter reset"

counter_agent = Agent(
    name="Counter",
    model=OpenAIChat(id="gpt-4o"),
    tools=[increment_counter, reset_counter],
    instructions="Manage a counter using the provided tools",
)
```

## Best Practices

### Tool Parameter Order

Always put `session_state` first:

```python
# Good
def my_tool(session_state: dict, param1: str, param2: int) -> str:
    pass

# Avoid
def my_tool(param1: str, session_state: dict, param2: int) -> str:
    pass
```

### Type Hints

Use proper type hints for clarity:

```python
from typing import Dict, Any

def my_tool(session_state: Dict[str, Any], item: str) -> str:
    pass
```

### Safe Access

Always use `.get()` with defaults:

```python
def safe_tool(session_state: dict, value: str) -> str:
    items = session_state.get("items", [])  # ✅ Safe
    items.append(value)
    session_state["items"] = items
    return "Success"
```

## Related Topics

<CardGroup cols={2}>
  <Card title="Custom Functions" icon="code" href="/basics/sessions/workflow-sessions/session-state/usage/custom-functions">
    Use state in custom functions
  </Card>
  <Card title="Conditions & Routers" icon="code-branch" href="/basics/sessions/workflow-sessions/session-state/usage/conditions-routers">
    Use state in workflow control flow
  </Card>
</CardGroup>

