---
title: Workflow Agents
sidebarTitle: Workflow Agents
description: Use agents that intelligently decide when to run workflows
---

## What are Workflow Agents?

A Workflow Agent is a special type of agent that acts as a smart orchestrator for your workflow. Instead of always executing all workflow steps, the WorkflowAgent decides whether to run the workflow or answer directly from previous workflow history.

Think of it as adding an intelligent decision layer on top of your workflow that can:
- Answer questions about previous workflow runs without re-executing
- Compare or analyze results from past executions
- Only trigger new workflow runs when genuinely needed

## Why Use Workflow Agents?

Workflow Agents are useful when you want to:

- **Save computation costs** by avoiding unnecessary workflow executions
- **Answer follow-up questions** about previous runs without re-running
- **Enable analysis** of past workflow results (comparisons, summaries, trends)
- **Provide conversational interfaces** to workflow outputs
- **Make workflows smarter** about when they actually need to execute

## How Workflow Agents Work

When you add a WorkflowAgent to your workflow:

1. User sends input to the workflow
2. WorkflowAgent receives the input + workflow history
3. Agent decides: "Can I answer from history, or do I need to run the workflow?"
4. **Option A:** Answers directly from history (fast, no execution)
5. **Option B:** Calls `run_workflow` tool to execute (full workflow run)

```python
from agno.workflow import Workflow
from agno.workflow.agent import WorkflowAgent
from agno.models.openai import OpenAIChat

# Create a workflow agent
workflow_agent = WorkflowAgent(
    model=OpenAIChat(id="gpt-4o"),
    add_workflow_history=True,  # Give agent access to history
    num_history_runs=5,          # Include last 5 runs
)

# Add to workflow
workflow = Workflow(
    name="Research Pipeline",
    description="Researches topics and generates reports",
    agent=workflow_agent,  # ← This makes it intelligent
    steps=[...],
    db=SqliteDb(db_file="research.db"),
)

# First run - agent executes workflow
result1 = workflow.run(input="Research AI trends")

# Second run - agent might answer from history without executing
result2 = workflow.run(input="What were the AI trends you just researched?")
# Agent sees previous result and answers directly!
```

## Creating Workflow Agents

### Basic Setup

```python
from agno.workflow.agent import WorkflowAgent
from agno.models.openai import OpenAIChat

workflow_agent = WorkflowAgent(
    model=OpenAIChat(id="gpt-4o"),  # Required: The LLM model
)

workflow = Workflow(
    name="My Workflow",
    agent=workflow_agent,
    steps=[...],
    db=SqliteDb(db_file="workflow.db"),
)
```

### With Custom Instructions

Add custom instructions to guide the agent's behavior:

```python
workflow_agent = WorkflowAgent(
    model=OpenAIChat(id="gpt-4o"),
    instructions="""
    You orchestrate a research workflow.
    
    Run the workflow for NEW research topics.
    Answer from history for follow-up questions about previous research.
    
    Be efficient: don't re-run the workflow unless truly necessary.
    """,
)
```

<Note>
Custom instructions are combined with default WorkflowAgent instructions that explain its role and available tools.
</Note>

### Controlling History Access

Configure how much workflow history the agent sees:

```python
workflow_agent = WorkflowAgent(
    model=OpenAIChat(id="gpt-4o"),
    add_workflow_history=True,   # Enable history (default: True)
    num_history_runs=10,          # See last 10 runs (default: 5)
)
```

You can disable history if you want the agent to always run the workflow:

```python
workflow_agent = WorkflowAgent(
    model=OpenAIChat(id="gpt-4o"),
    add_workflow_history=False,  # Agent won't see history
)
# Agent will always execute the workflow (no smart decisions)
```

## How History is Provided

Workflow Agents receive history differently than regular agents:

```python
# History is passed as a DEPENDENCY (not as messages)
{
    "workflow_context": """
        Workflow Description: Research and analyze topics
        
        <workflow_history_context>
        [Workflow Run-1]
        User input: Research AI trends
        Workflow output: AI trends include...
        
        [Workflow Run-2]
        User input: Research ML automation
        Workflow output: ML automation focuses on...
        </workflow_history_context>
    """
}
```

This context is injected into the agent's instructions via the `{workflow_context}` placeholder.

## Workflow Agent Behavior

### When Agent Runs the Workflow

The agent will execute the workflow (call `run_workflow` tool) when:

- The query is about a **new topic** not in history
- The user explicitly requests a **new execution**
- The question **cannot be answered** from existing history
- The user wants to **process new data**

```python
# These typically trigger workflow execution:
workflow.run(input="Research quantum computing")  # New topic
workflow.run(input="Run a new analysis on cloud security")  # Explicit request
workflow.run(input="Process this document: ...")  # New data
```

### When Agent Answers from History

The agent will answer directly (without execution) when:

- The question is about **previous runs**
- The user wants to **compare past results**
- The query is a **follow-up** about recent outputs
- The information is **available in history**

```python
# These typically get answered from history:
workflow.run(input="What did you find about AI trends?")  # Previous topic
workflow.run(input="Compare the last two research reports")  # Comparison
workflow.run(input="Summarize what we've researched so far")  # Summary
```

## Example Use Cases

### Research Workflow with Q&A

```python
from agno.workflow import Workflow
from agno.workflow.agent import WorkflowAgent
from agno.workflow.step import Step
from agno.agent import Agent
from agno.db.sqlite import SqliteDb
from agno.models.openai import OpenAIChat

# Create researcher agent
researcher = Agent(
    name="Researcher",
    model=OpenAIChat(id="gpt-4o"),
    instructions="Research topics thoroughly and provide detailed reports",
)

# Create workflow agent
workflow_agent = WorkflowAgent(
    model=OpenAIChat(id="gpt-4o"),
    num_history_runs=10,
    instructions="""
    You manage a research workflow.
    
    - Run NEW research when the user asks about topics not in history
    - Answer questions about PREVIOUS research from the workflow history
    - Be smart: only run the workflow when you need new information
    """,
)

# Create workflow
research_workflow = Workflow(
    name="Research Assistant",
    description="Researches topics and answers questions about findings",
    agent=workflow_agent,
    steps=[
        Step(name="Research", agent=researcher),
    ],
    db=SqliteDb(db_file="research.db"),
)

# Usage
research_workflow.run(input="Research artificial intelligence")
# → Executes workflow

research_workflow.run(input="What did you find about AI?")
# → Answers from history (no execution)

research_workflow.run(input="Now research machine learning")
# → Executes workflow (new topic)

research_workflow.run(input="Compare AI and ML findings")
# → Answers from history (both topics already researched)
```

### Content Generation with Memory

```python
content_workflow = Workflow(
    name="Content Generator",
    description="Generates blog posts and social media content",
    agent=WorkflowAgent(
        model=OpenAIChat(id="gpt-4o"),
        num_history_runs=20,
        instructions="""
        You manage a content generation workflow.
        
        - Generate NEW content when requested
        - Answer questions about PREVIOUS content from history
        - Help analyze and improve past content without regenerating
        """,
    ),
    steps=[
        Step(name="Generate Content", agent=content_creator),
    ],
    db=SqliteDb(db_file="content.db"),
)

# Generate new content
content_workflow.run(input="Write a blog post about Python best practices")
# → Executes workflow

# Ask about it
content_workflow.run(input="What topics did that blog post cover?")
# → Answers from history

# Analyze without regenerating
content_workflow.run(input="What's our total word count across all posts?")
# → Answers from history
```

### Multi-Stage Analysis

```python
analysis_workflow = Workflow(
    name="Data Analysis Pipeline",
    description="Analyzes data and generates insights",
    agent=WorkflowAgent(
        model=OpenAIChat(id="gpt-4o"),
        num_history_runs=15,
    ),
    steps=[
        Step(name="Load Data", agent=data_loader),
        Step(name="Analyze", agent=analyst),
        Step(name="Visualize", agent=visualizer),
    ],
    db=SqliteDb(db_file="analysis.db"),
)

# Run analysis
analysis_workflow.run(input="Analyze Q3 sales data")
# → Executes full 3-step workflow

# Get details without re-running
analysis_workflow.run(input="What were the key insights from Q3?")
# → Answers from history (saves compute!)

# Compare multiple runs
analysis_workflow.run(input="Analyze Q4 sales data")
# → Executes workflow (new data)

analysis_workflow.run(input="Compare Q3 and Q4 performance")
# → Answers from history (both are available)
```

## Workflow Agent vs Regular Agent

Understanding the difference:

| Feature | Regular Agent | Workflow Agent |
|---------|--------------|----------------|
| **Purpose** | Execute tasks directly | Orchestrate workflow execution |
| **Tools** | Can have any tools | Only has `run_workflow` tool |
| **History** | Gets conversation messages | Gets workflow run history |
| **Decision** | Responds to each message | Decides whether to run workflow |
| **Use case** | General-purpose tasks | Workflow orchestration only |

### Can't Use WorkflowAgent as Regular Agent

WorkflowAgent is restricted to workflow orchestration:

```python
# ✅ Correct: WorkflowAgent in workflow
workflow = Workflow(
    name="My Workflow",
    agent=WorkflowAgent(model=OpenAIChat(id="gpt-4o")),
    steps=[...],
)

# ❌ Incorrect: WorkflowAgent standalone
agent = WorkflowAgent(model=OpenAIChat(id="gpt-4o"))
agent.run(input="Hello")  # This won't work as expected
```

## Workflow History vs Agent History

When you use WorkflowAgent, you're working with workflow history (run-based), not agent history (message-based):

```python
# Workflow history (what WorkflowAgent sees)
<workflow_history_context>
[Workflow Run-1]
User input: Research AI
Workflow output: AI research report...

[Workflow Run-2]
User input: Research ML  
Workflow output: ML research report...
</workflow_history_context>

# This is DIFFERENT from agent message history
# (which would be individual chat messages)
```

The WorkflowAgent uses `num_history_runs` to control how many workflow runs it sees, not message count.

## Best Practices

### Write Clear Workflow Descriptions

Help the agent understand what the workflow does:

```python
# Good: Clear description
workflow = Workflow(
    name="Customer Support",
    description="Analyzes customer tickets and generates support responses",
    agent=workflow_agent,
    steps=[...],
)

# Avoid: Missing description
workflow = Workflow(
    name="Workflow 1",
    agent=workflow_agent,
    steps=[...],
)
```

### Provide Agent Instructions

Guide the agent's decision-making:

```python
workflow_agent = WorkflowAgent(
    model=OpenAIChat(id="gpt-4o"),
    instructions="""
    You manage a customer support workflow.
    
    Run the workflow for:
    - NEW customer tickets
    - Requests to generate NEW responses
    
    Answer from history for:
    - Questions about PREVIOUS tickets
    - Requests to review PAST responses
    - Comparisons of tickets
    """,
)
```

### Balance History Size

Too little history: Agent lacks context
Too much history: Consumes token budget

```python
# For quick Q&A workflows
workflow_agent = WorkflowAgent(
    model=OpenAIChat(id="gpt-4o"),
    num_history_runs=3,  # Just recent context
)

# For analysis and comparison workflows
workflow_agent = WorkflowAgent(
    model=OpenAIChat(id="gpt-4o"),
    num_history_runs=20,  # More history for analysis
)
```

### Monitor Execution Decisions

Log when the workflow actually runs vs when the agent answers from history:

```python
result = workflow.run(input="Your query")

if result.workflow_agent_run:
    if result.workflow_agent_run.tools:
        print("Agent executed the workflow")
    else:
        print("Agent answered from history")
```

## Troubleshooting

### Agent Always Runs Workflow

If the agent executes the workflow every time:

1. **Check history is enabled:** `add_workflow_history=True` (default)
2. **Verify database exists:** History requires `db` parameter
3. **Check for completed runs:** History only includes completed runs
4. **Review instructions:** Make sure instructions don't force execution

```python
# Correct setup for smart decisions
workflow_agent = WorkflowAgent(
    model=OpenAIChat(id="gpt-4o"),
    add_workflow_history=True,  # ✅ History enabled
)

workflow = Workflow(
    agent=workflow_agent,
    db=SqliteDb(db_file="workflow.db"),  # ✅ Database set
    steps=[...],
)
```

### Agent Never Runs Workflow

If the agent always answers from history:

- Check your instructions: You might be discouraging workflow execution
- Try explicit requests: "Run the workflow to analyze..."
- Verify the query needs new data that's not in history

### History Not Visible to Agent

If the agent doesn't seem aware of previous runs:

1. **Check num_history_runs:** Might be too small
2. **Verify runs completed successfully:** Failed runs don't appear in history
3. **Check session ID:** Different sessions have separate histories

## Next Steps

- **[Metrics](/basics/sessions/workflow-sessions/metrics)** - Track workflow performance
- **[Workflow History](/basics/sessions/workflow-sessions/workflow-history)** - Learn more about workflow history
- **[Overview](/basics/sessions/workflow-sessions/overview)** - Back to workflow sessions basics

## Developer Resources

- View [workflow agent examples](https://github.com/agno-agi/agno/tree/main/cookbook/workflows/_06_advanced_concepts/_07_workflow_history)
- See the [WorkflowAgent API](/reference/workflows/workflow)

