---
title: Opik
description: Stream Agno traces to Opik for deep observability, cost tracking, and production monitoring of your agents.
---

## Integrating Agno with Opik

[Opik](https://www.comet.com/opik/) is Comet's observability, evaluation, and optimization platform for LLM and agent workloads. By pointing Agno's OpenTelemetry exporter at Opik you can:

- Inspect the full agent → model → tool hierarchy for every request
- Track latency, token usage, and cost per span or per project
- Debug failures with captured stack traces and request context
- Group multi-turn conversations into threads and share them with your team

## Prerequisites

1. **Install dependencies**

   ```bash
   pip install -U opik agno openai opentelemetry-sdk opentelemetry-exporter-otlp openinference-instrumentation-agno
   ```

2. **Configure Opik**

   - Run `opik configure` and follow the prompts, or
   - Set the environment variables manually:
     ```bash
     export OPIK_API_KEY=<your-api-key>
     export OPIK_WORKSPACE=<workspace>
     export OPIK_PROJECT_NAME=<project>
     ```

3. **Set OTLP endpoint and headers**

   Choose the configuration that matches your deployment:

   ```bash wordWrap
   # Opik Cloud
   export OTEL_EXPORTER_OTLP_ENDPOINT=https://www.comet.com/opik/api/v1/private/otel
   export OTEL_EXPORTER_OTLP_HEADERS='Authorization=<your-api-key>,Comet-Workspace=<workspace>,projectName=<project>'

   # Opik Enterprise
   export OTEL_EXPORTER_OTLP_ENDPOINT=https://<your-comet-domain>/opik/api/v1/private/otel
   export OTEL_EXPORTER_OTLP_HEADERS='Authorization=<your-api-key>,Comet-Workspace=<workspace>,projectName=<project>'

   # Self-hosted Opik
   export OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:5173/api/v1/private/otel
   export OTEL_EXPORTER_OTLP_HEADERS='projectName=<project>'
   ```

## Sending Traces to Opik

The snippet below instruments Agno using OpenInference and exports spans to Opik:

```python
from agno.agent import Agent
from agno.models.openai import OpenAIChat
from agno.tools.yfinance import YFinanceTools
from openinference.instrumentation.agno import AgnoInstrumentor
from opentelemetry import trace as trace_api
from opentelemetry.exporter.otlp.proto.http.trace_exporter import OTLPSpanExporter
from opentelemetry.sdk.trace import TracerProvider
from opentelemetry.sdk.trace.export import SimpleSpanProcessor

# Configure the tracer provider with the Opik OTLP exporter
tracer_provider = TracerProvider()
tracer_provider.add_span_processor(SimpleSpanProcessor(OTLPSpanExporter()))
trace_api.set_tracer_provider(tracer_provider)

# Enable automatic instrumentation for Agno
AgnoInstrumentor().instrument()

agent = Agent(
    name="Stock Price Agent",
    model=OpenAIChat(id="gpt-4o-mini"),
    tools=[YFinanceTools()],
    instructions="You are a stock price analyst. Answer with concise, well-sourced updates.",
    debug_mode=True,
    trace_attributes={
        "session.id": "demo-session-001",
        "environment": "development",
    },
)

agent.print_response("What is the current price of Apple and how did it move today?")
```

Open the Opik dashboard, select your workspace and project, and you will see the agent span with its child model/tool spans, token usage, cost estimates, and metadata captured automatically.

## Additional resources

- [Opik Agno integration guide](https://www.comet.com/docs/opik/tracing/integrations/agno)
- [Agno cookbook example](https://github.com/agno-agi/agno/blob/main/cookbook/integrations/observability/opik_via_openinference.py)
